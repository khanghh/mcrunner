<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Server Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00bc8c',
                        'primary-dark': '#009670',
                        'primary-light': 'rgba(0, 188, 140, 0.1)',
                        secondary: '#375a7f',
                        dark: '#222',
                        darker: '#1a1a1a',
                        light: '#2c3e50',
                        text: '#ecf0f1',
                        'text-muted': '#bdc3c7',
                        border: '#34495e',
                        accent: '#e74c3c',
                        warning: '#f39c12',
                        success: '#2ecc71',
                        info: '#3498db',
                    },
                    fontFamily: {
                        'code': ['Consolas', 'Monaco', 'Courier New', 'monospace'],
                    },
                    boxShadow: {
                        'custom': '0 4px 12px rgba(0, 0, 0, 0.15)',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .animate-pulse-custom {
            animation: pulse 2s infinite;
        }
        
        /* Folder tree styles */
        .file-tree ul {
            list-style-type: none;
            padding-left: 1rem;
        }
        
        .file-tree > ul {
            padding-left: 0;
        }
        
        .file-tree .folder > ul {
            display: none;
        }
        
        .file-tree .folder.open > ul {
            display: block;
        }
        
        .file-tree .folder > .name::before {
            content: '▸';
            display: inline-block;
            width: 1em;
            margin-right: 0.25rem;
            transition: all 0.2s ease;
        }
        
        .file-tree .folder.open > .name::before {
            content: '▾';
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #2c3e50;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #34495e;
            border-radius: 4px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #4a6378;
        }
    </style>
</head>
<body class="bg-darker text-text h-screen overflow-hidden">
    <div class="app-container flex flex-col h-screen">
        <!-- Header -->
        <header class="bg-dark px-6 py-4 flex justify-between items-center shadow-custom z-10 relative">
            <div class="logo flex items-center gap-3 font-bold text-xl text-text">
                <i class="fas fa-cube text-primary text-2xl"></i>
                <span>Minecraft Server Editor</span>
            </div>
            <div class="server-status flex items-center gap-4 bg-light px-4 py-2 rounded-lg text-sm">
                <div class="status-indicator w-2.5 h-2.5 rounded-full bg-success shadow-[0_0_8px_#2ecc71] animate-pulse-custom"></div>
                <span>Server Status: Online</span>
                <div class="player-count flex items-center gap-1.5">
                    <i class="fas fa-users"></i>
                    <span>3/20</span>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs flex bg-dark border-b border-border px-6">
            <div class="tab active px-6 py-3.5 cursor-pointer border-b-3 border-transparent transition-all flex items-center gap-2 font-medium text-text-muted data-[active=true]:border-primary data-[active=true]:text-text data-[active=true]:bg-darker hover:text-text hover:bg-white/5" data-tab="file-explorer" data-active="true">
                <i class="fas fa-folder"></i>
                <span>File Explorer</span>
            </div>
            <div class="tab px-6 py-3.5 cursor-pointer border-b-3 border-transparent transition-all flex items-center gap-2 font-medium text-text-muted data-[active=true]:border-primary data-[active=true]:text-text data-[active=true]:bg-darker hover:text-text hover:bg-white/5" data-tab="terminal" data-active="false">
                <i class="fas fa-terminal"></i>
                <span>Server Terminal</span>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content flex-1 overflow-hidden relative bg-darker">
            <!-- File Explorer Panel -->
            <div class="panel absolute top-0 left-0 w-full h-full flex" id="file-explorer" data-active="true">
                <div class="file-explorer flex h-full w-full">
                    <!-- File Tree -->
                    <div class="file-tree w-72 bg-dark border-r border-border overflow-y-auto p-4 custom-scrollbar">
                        <ul>
                            <li class="folder group" data-path="config">
                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary">
                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-folder text-primary"></i></span>
                                    <span class="name font-semibold text-primary">config</span>
                                </div>
                                <ul>
                                    <li class="file group" data-path="config/server.properties">
                                        <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-4">
                                            <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                            <span class="name text-text">server.properties</span>
                                        </div>
                                    </li>
                                    <li class="file group" data-path="config/bukkit.yml">
                                        <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-4">
                                            <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                            <span class="name text-text">bukkit.yml</span>
                                        </div>
                                    </li>
                                    <li class="file group" data-path="config/spigot.yml">
                                        <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-4">
                                            <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                            <span class="name text-text">spigot.yml</span>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li class="folder group" data-path="plugins">
                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary">
                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-folder text-primary"></i></span>
                                    <span class="name font-semibold text-primary">plugins</span>
                                </div>
                                <ul>
                                    <li class="folder group" data-path="plugins/WorldEdit">
                                        <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-4">
                                            <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-folder text-primary"></i></span>
                                            <span class="name font-semibold text-primary">WorldEdit</span>
                                        </div>
                                        <ul>
                                            <li class="file group" data-path="plugins/WorldEdit/config.yml">
                                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-8">
                                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                                    <span class="name text-text">config.yml</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="folder group" data-path="plugins/Essentials">
                                        <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-4">
                                            <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-folder text-primary"></i></span>
                                            <span class="name font-semibold text-primary">Essentials</span>
                                        </div>
                                        <ul>
                                            <li class="file group" data-path="plugins/Essentials/config.yml">
                                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary ml-8">
                                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                                    <span class="name text-text">config.yml</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="file group" data-path="whitelist.json">
                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary">
                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file text-text"></i></span>
                                    <span class="name text-text">whitelist.json</span>
                                </div>
                            </li>
                            <li class="file group" data-path="ops.json">
                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary">
                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file text-text"></i></span>
                                    <span class="name text-text">ops.json</span>
                                </div>
                            </li>
                            <li class="file group" data-path="server.jar">
                                <div class="flex items-center py-2 px-3 cursor-pointer rounded-lg transition-all hover:bg-light group-[.active]:bg-primary-light group-[.active]:text-primary">
                                    <span class="icon w-4 inline-block mr-2 text-center"><i class="fas fa-file-code text-text"></i></span>
                                    <span class="name text-text">server.jar</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Editor -->
                    <div class="editor-container flex-1 flex flex-col overflow-hidden">
                        <div class="editor-header bg-dark px-5 py-3.5 border-b border-border flex justify-between items-center">
                            <div class="file-info flex items-center gap-2.5 font-medium">
                                <i class="fas fa-file-code"></i>
                                <span>server.properties</span>
                            </div>
                            <div class="editor-actions flex gap-2.5">
                                <button class="btn btn-secondary px-4 py-2 border-none rounded-lg cursor-pointer flex items-center gap-1.5 transition-all font-medium text-sm bg-secondary text-white hover:bg-[#2c4a6b] hover:-translate-y-0.5">
                                    <i class="fas fa-sync-alt"></i>
                                    <span>Reload</span>
                                </button>
                                <button class="btn btn-primary px-4 py-2 border-none rounded-lg cursor-pointer flex items-center gap-1.5 transition-all font-medium text-sm bg-primary text-white hover:bg-primary-dark hover:-translate-y-0.5">
                                    <i class="fas fa-save"></i>
                                    <span>Save</span>
                                </button>
                            </div>
                        </div>
                        <div class="code-editor flex-1 bg-darker p-5 overflow-auto">
                            <textarea id="code-textarea" class="w-full h-full bg-dark text-text border border-border rounded-lg p-5 font-code text-sm resize-none outline-none focus:border-primary focus:shadow-[0_0_0_2px_rgba(0,188,140,0.2)] transition-all">
# Minecraft server properties
# Last modified: 2023-10-15

server-port=25565
max-players=20
level-name=world
online-mode=true
difficulty=normal
enable-command-block=true
motd=A Minecraft Server
pvp=true
allow-flight=false
enforce-whitelist=false
spawn-protection=16
view-distance=10
server-ip=

# Game settings
gamemode=survival
hardcore=false
allow-nether=true
spawn-animals=true
spawn-npcs=true
spawn-monsters=true
generate-structures=true

# Server resource pack
resource-pack=
                            </textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Terminal Panel -->
            <div class="panel absolute top-0 left-0 w-full h-full flex flex-col bg-darker" id="terminal" data-active="false">
                <div class="terminal-container flex flex-col h-full w-full">
                    <div class="terminal-header bg-dark px-5 py-3.5 border-b border-border flex justify-between items-center">
                        <div class="terminal-title flex items-center gap-2.5 font-medium">
                            <i class="fas fa-terminal"></i>
                            <span>Server Console</span>
                        </div>
                        <div class="terminal-controls flex gap-2.5">
                            <button class="btn btn-clear px-4 py-2 border-none rounded-lg cursor-pointer flex items-center gap-1.5 transition-all font-medium text-sm bg-secondary text-white hover:bg-[#2c4a6b] hover:-translate-y-0.5">
                                <i class="fas fa-trash"></i>
                                <span>Clear</span>
                            </button>
                            <button class="btn btn-stop px-4 py-2 border-none rounded-lg cursor-pointer flex items-center gap-1.5 transition-all font-medium text-sm bg-secondary text-white hover:bg-[#2c4a6b] hover:-translate-y-0.5">
                                <i class="fas fa-stop"></i>
                                <span>Stop</span>
                            </button>
                            <button class="btn btn-restart px-4 py-2 border-none rounded-lg cursor-pointer flex items-center gap-1.5 transition-all font-medium text-sm bg-secondary text-white hover:bg-[#2c4a6b] hover:-translate-y-0.5">
                                <i class="fas fa-redo"></i>
                                <span>Restart</span>
                            </button>
                        </div>
                    </div>
                    <div class="terminal-logs flex-1 p-5 overflow-y-auto font-code text-sm bg-[#0d1117] border-b border-border custom-scrollbar" id="terminal-logs">
                        <div class="log-entry log-info mb-2 text-info">[12:34:56 INFO]: Starting Minecraft server on *:25565</div>
                        <div class="log-entry log-info mb-2 text-info">[12:34:56 INFO]: Preparing level "world"</div>
                        <div class="log-entry log-info mb-2 text-info">[12:34:57 INFO]: Loaded 7 recipes</div>
                        <div class="log-entry log-info mb-2 text-info">[12:34:58 INFO]: Loaded 1184 advancements</div>
                        <div class="log-entry log-success mb-2 text-success">[12:35:01 INFO]: Done (4.123s)! For help, type "help"</div>
                        <div class="log-entry log-info mb-2 text-info">[12:35:05 INFO]: Player123 joined the game</div>
                        <div class="log-entry log-info mb-2 text-info">[12:35:10 INFO]: CreeperHunter joined the game</div>
                        <div class="log-entry log-info mb-2 text-info">[12:35:15 INFO]: MineCrafter99 joined the game</div>
                        <div class="log-entry log-warning mb-2 text-warning">[12:36:22 WARN]: Can't keep up! Is the server overloaded?</div>
                        <div class="log-entry log-info mb-2 text-info">[12:37:45 INFO]: Player123 issued server command: /time set day</div>
                        <div class="log-entry log-info mb-2 text-info">[12:38:10 INFO]: CreeperHunter was slain by Zombie</div>
                        <div class="log-entry log-info mb-2 text-info">[12:40:33 INFO]: MineCrafter99 issued server command: /give Player123 minecraft:diamond 5</div>
                    </div>
                    <div class="terminal-input-container p-5 flex gap-3">
                        <input type="text" class="terminal-input flex-1 bg-dark text-text border border-border rounded-lg px-4 py-3 font-code outline-none transition-all focus:border-primary focus:shadow-[0_0_0_2px_rgba(0,188,140,0.2)]" placeholder="Enter server command...">
                        <button class="btn-terminal bg-primary text-white border-none rounded-lg px-5 py-3 cursor-pointer transition-all font-medium flex items-center gap-1.5 hover:bg-primary-dark hover:-translate-y-0.5">
                            <i class="fas fa-paper-plane"></i>
                            <span>Send</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and panels
                document.querySelectorAll('.tab').forEach(t => {
                    t.setAttribute('data-active', 'false');
                    t.classList.remove('border-primary', 'text-text', 'bg-darker');
                    t.classList.add('text-text-muted', 'border-transparent');
                });
                
                document.querySelectorAll('.panel').forEach(p => {
                    p.setAttribute('data-active', 'false');
                    p.classList.add('hidden');
                });
                
                // Add active class to clicked tab and corresponding panel
                tab.setAttribute('data-active', 'true');
                tab.classList.remove('text-text-muted', 'border-transparent');
                tab.classList.add('border-primary', 'text-text', 'bg-darker');
                
                const tabId = tab.getAttribute('data-tab');
                const panel = document.getElementById(tabId);
                panel.setAttribute('data-active', 'true');
                panel.classList.remove('hidden');
            });
        });

        // File tree: use event delegation to handle folder toggle and file open
        const fileTree = document.querySelector('.file-tree');
        const codeTextarea = document.getElementById('code-textarea');

        const SAMPLE_FILES = {
            'config/server.properties': `# Minecraft server properties\nmax-players=20\nmotd=My Server`,
            'config/bukkit.yml': '# bukkit config...\n',
            'config/spigot.yml': '# spigot config...\n',
            'plugins/WorldEdit/config.yml': '# worldedit config...\n',
            'plugins/Essentials/config.yml': '# essentials config...\n',
            'whitelist.json': '[\n  "Player123"\n]',
            'ops.json': '[\n  { "uuid": "0000-0000", "name": "Admin" }\n]'
        };

        function clearActive() {
            fileTree.querySelectorAll('.group').forEach(item => {
                item.classList.remove('active');
            });
        }

        function openFile(path, liElem){
            clearActive();
            if(liElem) liElem.classList.add('active');
            const name = path.split('/').pop();
            document.querySelector('.file-info span').textContent = name;
            codeTextarea.value = SAMPLE_FILES[path] ?? `// ${name} is empty or binary`;
        }

        fileTree.addEventListener('click', (e) => {
            // find the closest folder or file element
            let el = e.target.closest('.folder, .file');
            if(!el) return;

            if(el.classList.contains('folder')){
                // toggle folder open/closed
                el.classList.toggle('open');
                return;
            }

            if(el.classList.contains('file')){
                const path = el.getAttribute('data-path');
                openFile(path, el);
            }
        });

        // Terminal command submission
        const terminalInput = document.querySelector('.terminal-input');
        const terminalLogs = document.getElementById('terminal-logs');
        
        document.querySelector('.btn-terminal').addEventListener('click', sendCommand);
        terminalInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendCommand();
            }
        });

        // terminal control buttons
        const btnClear = document.querySelector('.btn-clear');
        const btnStop = document.querySelector('.btn-stop');
        const btnRestart = document.querySelector('.btn-restart');

        btnClear.addEventListener('click', () => {
            terminalLogs.innerHTML = '';
        });

        let stopped = false;
        btnStop.addEventListener('click', () => {
            stopped = true;
            terminalInput.disabled = true;
            appendLog('Server stopped', 'error');
        });

        btnRestart.addEventListener('click', () => {
            if(!stopped){
                appendLog('Server is restarting...', 'info');
            }
            stopped = false;
            terminalInput.disabled = false;
            // simulate server restart sequence
            appendLog('Stopping server...', 'info');
            setTimeout(()=> appendLog('Starting server...', 'info'), 800);
            setTimeout(()=> appendLog('Done (0.512s)! For help, type "help"', 'success'), 1600);
        });

        function appendLog(text, type='info'){
            const div = document.createElement('div');
            let colorClass = 'text-info';
            if (type === 'error') colorClass = 'text-accent';
            else if (type === 'success') colorClass = 'text-success';
            else if (type === 'warning') colorClass = 'text-warning';
            
            div.className = `log-entry mb-2 ${colorClass}`;
            div.textContent = `[${getCurrentTime()} ${type.toUpperCase()}]: ${text}`;
            terminalLogs.appendChild(div);
            terminalLogs.scrollTop = terminalLogs.scrollHeight;
        }

        function sendCommand() {
            const command = terminalInput.value.trim();
            if (command) {
                // Add command to logs
                const commandEntry = document.createElement('div');
                commandEntry.className = 'log-entry mb-2 text-info';
                commandEntry.textContent = `[${getCurrentTime()}] ${command}`;
                terminalLogs.appendChild(commandEntry);
                
                // Clear input
                terminalInput.value = '';
                
                // Send command to server
                fetch('/api/v1/server/command', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ command }),
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to send command');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Command sent:', data);
                })
                .catch(error => {
                    console.error('Error sending command:', error);
                    const errorEntry = document.createElement('div');
                    errorEntry.className = 'log-entry mb-2 text-accent';
                    errorEntry.textContent = `[${getCurrentTime()} ERROR]: Failed to send command`;
                    terminalLogs.appendChild(errorEntry);
                    terminalLogs.scrollTop = terminalLogs.scrollHeight;
                });
                
                // Scroll to bottom
                terminalLogs.scrollTop = terminalLogs.scrollHeight;
            }
        }

        function getCurrentTime() {
            const now = new Date();
            return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
        }

        // Simulate server logs for demo purposes
        setInterval(() => {
            const logTypes = ['info', 'info', 'info', 'info', 'warning'];
            const logMessages = [
                'A zombie was slain by Player123',
                'CreeperHunter mined diamond ore',
                'MineCrafter99 placed a block',
                'Server performance is normal',
                'Can\'t keep up! Is the server overloaded?'
            ];
            
            const randomType = logTypes[Math.floor(Math.random() * logTypes.length)];
            const randomMessage = logMessages[Math.floor(Math.random() * logMessages.length)];
            
            const logEntry = document.createElement('div');
            let colorClass = 'text-info';
            if (randomType === 'warning') colorClass = 'text-warning';
            
            logEntry.className = `log-entry mb-2 ${colorClass}`;
            logEntry.textContent = `[${getCurrentTime()} ${randomType.toUpperCase()}]: ${randomMessage}`;
            
            terminalLogs.appendChild(logEntry);
            terminalLogs.scrollTop = terminalLogs.scrollHeight;
        }, 10000); // Add a log every 10 seconds
    </script>
</body>
</html>